const t=1e-6,s=5e5;class i{static fromObject(t){return new i(t.x,t.y)}static fromArray(t){return new i(t[0],t[1])}constructor(t=0,s=0){this.x=t,this.y=s}*[Symbol.iterator](){yield this.x,yield this.y}clone(){return new i(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toArray(){return[this.x,this.y]}distance(t){const s=t.x-this.x,i=t.y-this.y;return Math.sqrt(s*s+i*i)}magnitudeSquared(){return this.x*this.x+this.y*this.y}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}dot(t){return this.x*t.x+this.y*t.y}apply(t){return this.x=t(this.x),this.y=t(this.y),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,s){return this.x=l(this.x,t.x,s.x),this.y=l(this.y,t.y,s.y),this}neg(){return this.x=-this.x,this.y=-this.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}mul(t){return this.x*=t.x,this.y*=t.y,this}div(t){return this.x/=t.x,this.y/=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}subScalar(t){return this.x-=t,this.y-=t,this}mulScalar(t){return this.x*=t,this.y*=t,this}divScalar(t){return this.x/=t,this.y/=t,this}setLength(t){const s=this.x*this.x+this.y*this.y;if(0===s)return this.x=this.y=0,this;const i=t/Math.sqrt(s);return this.x*=i,this.y*=i,this}normalize(){const t=this.x*this.x+this.y*this.y;if(0===t)return this.x=this.y=0,this;const s=1/Math.sqrt(t);return this.x*=s,this.y*=s,this}transformMatrix4(t){const s=this.x,i=this.y;return this.x=s*t.m00+i*t.m10+t.m20,this.y=s*t.m01+i*t.m11+t.m21,this}transformMatrix3(t){const s=this.x,i=this.y;return this.x=s*t.m00+i*t.m10+t.m20,this.y=s*t.m01+i*t.m11+t.m21,this}transformMatrix2(t){const s=this.x,i=this.y;return this.x=s*t.m00+i*t.m10,this.y=s*t.m01+i*t.m11,this}cross(){return this.x*this.y-this.y*this.x}set(t,s){return this.x=t,this.y=s,this}copy(t){return this.x=t.x,this.y=t.y,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this}subScaledVector(t,s){return this.x-=t.x*s,this.y-=t.y*s,this}negVector(t){return this.x=-t.x,this.y=-t.y,this}addVectors(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this}mulVectors(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this}divVectors(t,s){return this.x=t.x/s.x,this.y=t.y/s.y,this}lerpVectors(t,s,i=0){return this.x=(s.x-t.x)*i+t.x,this.y=(s.y-t.y)*i+t.y,this}}class h{static fromObject(t){return new h(t.x,t.y,t.z)}static fromArray(t){return new h(t[0],t[1],t[2])}constructor(t=0,s=0,i=0){this.x=t,this.y=s,this.z=i}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}clone(){return new h(this.x,this.y,this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toArray(){return[this.x,this.y,this.z]}distance(t){const s=t.x-this.x,i=t.y-this.y,h=t.z-this.z;return Math.sqrt(s*s+i*i+h*h)}magnitudeSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}apply(t){return this.x=t(this.x),this.y=t(this.y),this.z=t(this.z),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,s){return this.x=l(this.x,t.x,s.x),this.y=l(this.y,t.y,s.y),this.z=l(this.z,t.z,s.z),this}neg(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}mul(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}div(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}mulScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this}setLength(t){const s=this.x,i=this.y,h=this.z,e=s*s+i*i+h*h;if(0==e)return this.x=this.y=this.z=0,this;const n=t/Math.sqrt(e);return this.x=s*n,this.y=i*n,this.z=h*n,this}normalize(){const t=this.x,s=this.y,i=this.z,h=t*t+s*s+i*i;if(0!==h){const e=1/Math.sqrt(h);return this.x=t*e,this.y=s*e,this.z=i*e,this}return this.x=this.y=this.z=0,this}transformMatrix3(t){const s=this.x,i=this.y,h=this.z;return this.x=s*t.m00+i*t.m10+h*t.m20,this.y=s*t.m01+i*t.m11+h*t.m21,this.z=s*t.m02+i*t.m12+h*t.m22,this}transformMatrix4(t){const s=this.x,i=this.y,h=this.z;return this.x=s*t.m00+i*t.m10+h*t.m20+t.m30,this.y=s*t.m01+i*t.m11+h*t.m21+t.m31,this.z=s*t.m02+i*t.m12+h*t.m22+t.m32,this}cross(t){const s=this.x,i=this.y,h=this.z,e=t.x,n=t.y,m=t.z;return this.x=i*m-n*h,this.y=h*e-m*s,this.z=s*n-e*i,this}set(t,s,i){return this.x=t,this.y=s,this.z=i,this}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this}subScaledVector(t,s){return this.x-=t.x*s,this.y-=t.y*s,this.z-=t.z*s,this}negVector(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this}addVectors(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this}mulVectors(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this.z=t.z*s.z,this}divVectors(t,s){return this.x=t.x/s.x,this.y=t.y/s.y,this.z=t.z/s.z,this}lerpVectors(t,s,i=0){const h=t.x,e=t.y,n=t.z,m=s.x,a=s.y,r=s.z;return this.x=(m-h)*i+h,this.y=(a-e)*i+e,this.z=(r-n)*i+n,this}crossVectors(t,s){const i=t.x,h=t.y,e=t.z,n=s.x,m=s.y,a=s.z;return this.x=h*a-m*e,this.y=e*n-a*i,this.z=i*m-n*h,this}}class e{static fromObject(t){return new e(t.x,t.y,t.z,t.w)}static fromArray(t){return new e(t[0],t[1],t[2],t[3])}constructor(t=0,s=0,i=0,h=1){this.x=t,this.y=s,this.z=i,this.w=h}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}clone(){return new e(this.x,this.y,this.z,this.w)}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}toArray(){return[this.x,this.y,this.z,this.w]}distance(t){const s=t.x-this.x,i=t.y-this.y,h=t.z-this.z;return Math.sqrt(s*s+i*i+h*h)}magnitudeSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}apply(t){return this.x=t(this.x),this.y=t(this.y),this.z=t(this.z),this.w=t(this.w),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,s){return this.x=l(this.x,t.x,s.x),this.y=l(this.y,t.y,s.y),this.z=l(this.z,t.z,s.z),this.w=l(this.w,t.w,s.w),this}neg(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}mul(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}div(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}mulScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this}setLength(t){const s=this.x*this.x+this.y*this.y+this.z*this.z;if(0===s)return this.x=0,this.y=0,this.z=0,this.w=1,this;const i=t/Math.sqrt(s);return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this}normalize(){const t=this.x*this.x+this.y*this.y+this.z*this.z;if(0===t)return this.x=0,this.y=0,this.z=0,this.w=1,this;const s=1/Math.sqrt(t);return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this}transformMatrix4(t){const s=this.x,i=this.y,h=this.z,e=this.w;return this.x=s*t.m00+i*t.m10+h*t.m20+e*t.m30,this.y=s*t.m01+i*t.m11+h*t.m21+e*t.m31,this.z=s*t.m02+i*t.m12+h*t.m22+e*t.m32,this.w=s*t.m03+i*t.m13+h*t.m23+e*t.m33,this}cross(t){const s=this.x,i=this.y,h=this.z,e=this.w,n=t.x,m=t.y,a=t.z;return t.w,this.x=i*a-m*h,this.y=h*n-a*s,this.z=s*m-n*i,this.w=e,this}set(t,s,i,h){return this.x=t,this.y=s,this.z=i,this.w=h,this}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this.w+=t.w*s,this}subScaledVector(t,s){return this.x-=t.x*s,this.y-=t.y*s,this.z-=t.z*s,this.w-=t.w*s,this}negVector(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this.w=-t.w,this}addVectors(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this.w=t.w+s.w,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this.w=t.w-s.w,this}mulVectors(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this.z=t.z*s.z,this.w=t.w*s.w,this}divVectors(t,s){return this.x=t.x/s.x,this.y=t.y/s.y,this.z=t.z/s.z,this.w=t.w/s.w,this}lerpVectors(t,s,i=0){return this.x=(s.x-t.x)*i+t.x,this.y=(s.y-t.y)*i+t.y,this.z=(s.z-t.z)*i+t.z,this.w=(s.w-t.w)*i+t.w,this}crossVectors(t,s){const i=t.x,h=t.y,e=t.z,n=t.w,m=s.x,a=s.y,r=s.z;return s.w,this.x=h*r-a*e,this.y=e*m-r*i,this.z=i*a-m*h,this.w=n,this}}class n{constructor(t=0,s=0,i=0,h=0){this.min_x=t,this.max_x=i,this.min_y=s,this.max_y=h}clone(){return new n(this.min_x,this.min_y,this.max_x,this.max_y)}set(t=0,s=0,i=0,h=0){return this.min_x=t,this.max_x=i,this.min_y=s,this.max_y=h,this}copy(t){return this.min_x=t.min_x,this.max_x=t.max_x,this.min_y=t.min_y,this.max_y=t.max_y,this}grow(t){return this.min_x-=t,this.min_y-=t,this.max_x+=t,this.max_y+=t,this}mul(t){return this.min_x*=t,this.min_y*=t,this.max_x*=t,this.max_y*=t,this}transformMatrix2(t){const s=t.m00,i=t.m01,h=t.m10,e=t.m11,n=s*this.min_x,m=i*this.min_x,a=s*this.max_x,r=i*this.max_x,o=h*this.min_y,c=e*this.min_y,l=h*this.max_y,x=e*this.max_y,d=Math.min(n,a),u=Math.min(m,r),_=Math.max(n,a),y=Math.max(m,r),p=Math.min(o,l),z=Math.min(c,x),M=Math.max(o,l),f=Math.max(c,x);return this.min_x=d+p,this.min_y=u+z,this.max_x=_+M,this.max_y=y+f,this}transformMatrix3(t){const s=t.m00,i=t.m01,h=t.m10,e=t.m11,n=t.m20,m=t.m21,a=s*this.min_x,r=i*this.min_x,o=s*this.max_x,c=i*this.max_x,l=h*this.min_y,x=e*this.min_y,d=h*this.max_y,u=e*this.max_y,_=Math.min(a,o),y=Math.min(r,c),p=Math.max(a,o),z=Math.max(r,c),M=Math.min(l,d),f=Math.min(x,u),w=Math.max(l,d),g=Math.max(x,u);return this.min_x=_+M+n,this.min_y=y+f+m,this.max_x=p+w+n,this.max_y=z+g+m,this}unionBoxes(t,s){return this.min_x=Math.min(t.min_x,s.min_x),this.min_y=Math.min(t.min_y,s.min_y),this.max_x=Math.max(t.max_x,s.max_x),this.max_y=Math.max(t.max_y,s.max_y),this}intersectBoxes(t,s){return this.min_x=Math.max(t.min_x,s.min_x),this.min_y=Math.max(t.min_y,s.min_y),this.max_x=Math.min(t.max_x,s.max_x),this.max_y=Math.min(t.max_y,s.max_y),this}union(t){return this.unionBoxes(this,t)}intersect(t){return this.intersectBoxes(this,t)}}class m{constructor(t=0,s=0,i=0,h=0,e=0,n=0){this.min_x=t,this.min_y=s,this.min_z=i,this.max_x=h,this.max_y=e,this.max_z=n}clone(){return new m(this.min_x,this.min_y,this.min_z,this.max_x,this.max_y,this.max_z)}set(t=0,s=0,i=0,h=0,e=0,n=0){return this.min_x=t,this.min_y=s,this.min_z=i,this.max_x=h,this.max_y=e,this.max_z=n,this}copy(t){return this.min_x=t.min_x,this.min_y=t.min_y,this.min_z=t.min_z,this.max_x=t.max_x,this.max_y=t.max_y,this.max_z=t.max_z,this}grow(t){return this.min_x-=t,this.min_y-=t,this.min_z-=t,this.max_x+=t,this.max_y+=t,this.max_z+=t,this}mul(t){return this.min_x*=t,this.min_y*=t,this.min_z*=t,this.max_x*=t,this.max_y*=t,this.max_z*=t,this}transformMatrix3(t){const s=t.m00,i=t.m01,h=t.m02,e=t.m10,n=t.m11,m=t.m12,a=t.m20,r=t.m21,o=t.m22,c=s*this.min_x,l=i*this.min_x,x=h*this.min_x,d=s*this.max_x,u=i*this.max_x,_=h*this.max_x,y=e*this.min_y,p=n*this.min_y,z=m*this.min_y,M=e*this.max_y,f=n*this.max_y,w=m*this.max_y,g=a*this.min_z,b=r*this.min_z,S=o*this.min_z,D=a*this.max_z,k=r*this.max_z,v=o*this.max_z,F=Math.min(c,d),E=Math.min(l,u),q=Math.min(x,_),V=Math.max(c,d),X=Math.max(l,u),Y=Math.max(x,_),Z=Math.min(y,M),I=Math.min(p,f),C=Math.min(z,w),A=Math.max(y,M),T=Math.max(p,f),U=Math.max(z,w),B=Math.min(g,D),O=Math.min(b,k),P=Math.min(S,v),j=Math.max(g,D),$=Math.max(b,k),L=Math.max(S,v);return this.min_x=F+Z+B,this.min_y=E+I+O,this.min_z=q+C+P,this.max_x=V+A+j,this.max_y=X+T+$,this.max_z=Y+U+L,this}transformMatrix4(t){const s=t.m00,i=t.m01,h=t.m02,e=t.m10,n=t.m11,m=t.m12,a=t.m20,r=t.m21,o=t.m22,c=t.m30,l=t.m31,x=t.m32,d=s*this.min_x,u=i*this.min_x,_=h*this.min_x,y=s*this.max_x,p=i*this.max_x,z=h*this.max_x,M=e*this.min_y,f=n*this.min_y,w=m*this.min_y,g=e*this.max_y,b=n*this.max_y,S=m*this.max_y,D=a*this.min_z,k=r*this.min_z,v=o*this.min_z,F=a*this.max_z,E=r*this.max_z,q=o*this.max_z,V=Math.min(d,y),X=Math.min(u,p),Y=Math.min(_,z),Z=Math.max(d,y),I=Math.max(u,p),C=Math.max(_,z),A=Math.min(M,g),T=Math.min(f,b),U=Math.min(w,S),B=Math.max(M,g),O=Math.max(f,b),P=Math.max(w,S),j=Math.min(D,F),$=Math.min(k,E),L=Math.min(v,q),N=Math.max(D,F),Q=Math.max(k,E),G=Math.max(v,q);return this.min_x=V+A+j+c,this.min_y=X+T+$+l,this.min_z=Y+U+L+x,this.max_x=Z+B+N+c,this.max_y=I+O+Q+l,this.max_z=C+P+G+x,this}unionBoxes(t,s){return this.min_x=Math.min(t.min_x,s.min_x),this.min_y=Math.min(t.min_y,s.min_y),this.min_z=Math.min(t.min_z,s.min_z),this.max_x=Math.max(t.max_x,s.max_x),this.max_y=Math.max(t.max_y,s.max_y),this.max_z=Math.max(t.max_z,s.max_z),this}intersectBoxes(t,s){return this.min_x=Math.max(t.min_x,s.min_x),this.min_y=Math.max(t.min_y,s.min_y),this.min_z=Math.max(t.min_z,s.min_z),this.max_x=Math.min(t.max_x,s.max_x),this.max_y=Math.min(t.max_y,s.max_y),this.max_z=Math.min(t.max_z,s.max_z),this}union(t){return this.unionBoxes(this,t)}intersect(t){return this.intersectBoxes(this,t)}}class a{constructor(t,s,i,h){this.normal_x=t,this.normal_y=s,this.normal_z=i,this.distance=h}getOrigin(t=new h){return t.set(this.normal_x*this.distance,this.normal_y*this.distance,this.normal_z*this.distance)}getNormal(t=new h){return t.set(this.normal_x,this.normal_y,this.normal_z)}clone(){return new a(this.normal_x,this.normal_y,this.normal_z,this.distance)}dotPlane(t){return this.normal_x*t.normal_x+this.normal_y*t.normal_y+this.normal_z*t.normal_z}dotVector(t){return this.normal_x*t.x+this.normal_y*t.y+this.normal_z*t.z}copy(t){return this.normal_x=t.normal_x,this.normal_y=t.normal_y,this.normal_z=t.normal_z,this.distance=t.distance,this}equals(s){const i=s.normal_x-this.normal_x,h=s.normal_y-this.normal_y,e=s.normal_z-this.normal_z,n=Math.abs(this.distance-s.distance),m=Math.sqrt(i*i+h*h+e*e);return n<=t&&m<=t}flip(){return this.normal_x=-this.normal_x,this.normal_y=-this.normal_y,this.normal_z=-this.normal_z,this.distance=-this.distance,this}distanceToPoint(t,s,i){return t*this.normal_x+s*this.normal_y+i*this.normal_z-this.distance}projectionOfPoint(t,s,i){const e=t*this.normal_x+s*this.normal_y+i*this.normal_z-this.distance;return new h(t-e*this.normal_x,s-e*this.normal_y,i-e*this.normal_z)}transformMatrix3(t,s){const i=this.normal_x,h=this.normal_y,e=this.normal_z,n=this.distance,m=i*n*t.m00+h*n*t.m10+e*n*t.m20,a=i*n*t.m01+h*n*t.m11+e*n*t.m21,r=i*n*t.m02+h*n*t.m12+e*n*t.m22,o=i*s.m00+h*s.m10+e*s.m20,c=i*s.m01+h*s.m11+e*s.m21,l=i*s.m02+h*s.m12+e*s.m22,x=o*m+c*a+l*r;return this.normal_x=o,this.normal_y=c,this.normal_z=l,this.distance=x,this}transformMatrix4(t,s){const i=this.normal_x,h=this.normal_y,e=this.normal_z,n=this.distance,m=i*n*t.m00+h*n*t.m10+e*n*t.m20+t.m30,a=i*n*t.m01+h*n*t.m11+e*n*t.m21+t.m31,r=i*n*t.m02+h*n*t.m12+e*n*t.m22+t.m32,o=i*s.m00+h*s.m10+e*s.m20,c=i*s.m01+h*s.m11+e*s.m21,l=i*s.m02+h*s.m12+e*s.m22,x=o*m+c*a+l*r;return this.normal_x=o,this.normal_y=c,this.normal_z=l,this.distance=x,this}fromNormalAndPoint(t,s,i,h,e,n){const m=t*h+s*e+i*n;return this.normal_x=t,this.normal_y=s,this.normal_z=i,this.distance=m,this}fromPoints(t,s,i,h,e,n,m,r,o){const c=h-t,l=e-s,x=n-i,d=m-t,u=r-s,_=o-i,y=l*_-u*x,p=x*d-_*c,z=c*u-d*l,M=y*y+p*p+z*z;if(0===M)return new a(0,0,0,0);const f=1/Math.sqrt(M),w=y*f,g=p*f,b=z*f,S=w*t+g*s+b*i;return this.normal_x=w,this.normal_y=g,this.normal_z=b,this.distance=S,this}fromVectors(t,s,i){return this.fromPoints(t.x,t.y,t.z,s.x,s.y,s.z,i.x,i.y,i.z)}}class r{static identity(){return new r(1,0,0,1)}static scale(t,s){return new r(t,0,0,s)}static rotate(t){const s=Math.cos(t),i=Math.sin(t);return new r(s,-i,i,s)}constructor(t=1,s=0,i=0,h=1){this.m00=t,this.m01=i,this.m10=s,this.m11=h}clone(){return new r(this.m00,this.m10,this.m01,this.m11)}determinant(){return this.m00*this.m11-this.m10*this.m01}isIdentity(){return 1===this.m00&&0===this.m01&&0===this.m10&&1===this.m11}equals(s){return Math.abs(this.m00-s.m00)<=t&&Math.abs(this.m10-s.m10)<=t&&Math.abs(this.m01-s.m01)<=t&&Math.abs(this.m11-s.m11)<=t}identity(){return this.m00=1,this.m01=0,this.m10=0,this.m11=1,this}set(t,s,i,h){return this.m00=t,this.m01=s,this.m10=i,this.m11=h,this}copy(t){return this.m00=t.m00,this.m01=t.m01,this.m10=t.m10,this.m11=t.m11,this}transposeMatrix(t){const s=t.m00,i=t.m01,h=t.m10,e=t.m11;return this.m00=s,this.m01=h,this.m10=i,this.m11=e,this}mulMatrices(t,s){const i=t.m00,h=t.m01,e=t.m10,n=t.m11,m=s.m00,a=s.m01,r=s.m10,o=s.m11;return this.m00=i*m+h*r,this.m01=i*a+h*o,this.m10=e*m+n*r,this.m11=e*a+n*o,this}inverseMatrix(t){const s=t.m00,i=t.m01,h=t.m10,e=t.m11,n=s*e-h*i;if(0===n)throw new Error("Determinant of the matrix cannot be zero!");const m=1/n;return this.m00=e*m,this.m01=h*m,this.m10=i*m,this.m11=s*m,this}scaleMatrix(t,s,i){const h=t.m00,e=t.m01,n=t.m10,m=t.m11;return this.m00=s*h,this.m01=i*e,this.m10=s*n,this.m11=i*m,this}rotateMatrix(t,s){const i=t.m00,h=t.m01,e=t.m10,n=t.m11,m=Math.cos(s),a=Math.sin(s);return this.m00=m*i-a*h,this.m01=m*h+a*i,this.m10=m*e-a*n,this.m11=m*n+a*e,this}transpose(){return this.transposeMatrix(this)}inverse(){return this.inverseMatrix(this)}scale(t,s){return this.scaleMatrix(this,t,s)}rotate(t){return this.rotateMatrix(this,t)}}class o{static identity(){return new o(1,0,0,0,1,0,0,0,1)}static scale(t,s,i){return new o(t,0,0,0,s,0,0,0,i)}static translate(t,s){return new o(1,0,t,0,1,s,0,0,1)}static rotateX(t){const s=Math.cos(t),i=Math.sin(t);return new o(1,0,0,0,s,-i,0,i,s)}static rotateY(t){const s=Math.cos(t),i=Math.sin(t);return new o(s,0,i,0,1,0,-i,0,s)}static rotateZ(t){const s=Math.cos(t),i=Math.sin(t);return new o(s,-i,0,i,s,0,0,0,1)}static rotate(t,s,i,h){const e=Math.cos(h),n=Math.sin(h),m=1-e,a=Math.sqrt(t*t+s*s+i*i);if(0==a)throw new Error("axis vector length must be non zero!");const r=1/a,c=r*t,l=r*s,x=r*i,d=c*l,u=c*n,_=c*x,y=l*n,p=l*x,z=x*n;return new o(e+c*c*m,d*m-z,_*m+y,d*m+z,l*l*m+e,p*m-u,_*m-y,p*m+u,x*x*m+e)}constructor(t=1,s=0,i=0,h=0,e=1,n=0,m=0,a=0,r=1){this.m00=t,this.m01=h,this.m02=m,this.m10=s,this.m11=e,this.m12=a,this.m20=i,this.m21=n,this.m22=r}clone(){return new o(this.m00,this.m10,this.m20,this.m01,this.m11,this.m21,this.m02,this.m12,this.m22)}determinant(){return this.m00*(this.m11*this.m22-this.m12*this.m21)-this.m01*(this.m10*this.m22-this.m12*this.m20)+this.m02*(this.m10*this.m21-this.m11*this.m20)}isIdentity(){return 1===this.m00&&0===this.m01&&0===this.m02&&0===this.m10&&1===this.m11&&0===this.m12&&0===this.m20&&0===this.m21&&1===this.m22}equals(s){return Math.abs(this.m00-s.m00)<=t&&Math.abs(this.m10-s.m10)<=t&&Math.abs(this.m20-s.m20)<=t&&Math.abs(this.m01-s.m01)<=t&&Math.abs(this.m11-s.m11)<=t&&Math.abs(this.m21-s.m21)<=t&&Math.abs(this.m02-s.m02)<=t&&Math.abs(this.m12-s.m12)<=t&&Math.abs(this.m22-s.m22)<=t}identity(){return this.m00=1,this.m01=0,this.m02=0,this.m10=0,this.m11=1,this.m12=0,this.m20=0,this.m21=0,this.m22=1,this}set(t,s,i,h,e,n,m,a,r){return this.m00=t,this.m01=s,this.m02=i,this.m10=h,this.m11=e,this.m12=n,this.m20=m,this.m21=a,this.m22=r,this}copy(t){return this.m00=t.m00,this.m01=t.m01,this.m02=t.m02,this.m10=t.m10,this.m11=t.m11,this.m12=t.m12,this.m20=t.m20,this.m21=t.m21,this.m22=t.m22,this}transposeMatrix(t){const s=t.m00,i=t.m01,h=t.m02,e=t.m10,n=t.m11,m=t.m12,a=t.m20,r=t.m21,o=t.m22;return this.m00=s,this.m01=e,this.m02=a,this.m10=i,this.m11=n,this.m12=r,this.m20=h,this.m21=m,this.m22=o,this}mulMatrices(t,s){const i=t.m00,h=t.m01,e=t.m02,n=t.m10,m=t.m11,a=t.m12,r=t.m20,o=t.m21,c=t.m22,l=s.m00,x=s.m01,d=s.m02,u=s.m10,_=s.m11,y=s.m12,p=s.m20,z=s.m21,M=s.m22;return this.m00=i*l+h*u+e*p,this.m01=i*x+h*_+e*z,this.m02=i*d+h*y+e*M,this.m10=n*l+m*u+a*p,this.m11=n*x+m*_+a*z,this.m12=n*d+m*y+a*M,this.m20=r*l+o*u+c*p,this.m21=r*x+o*_+c*z,this.m22=r*d+o*y+c*M,this}inverseMatrix(t){const s=t.m00,i=t.m01,h=t.m02,e=t.m10,n=t.m11,m=t.m12,a=t.m20,r=t.m21,o=t.m22,c=n*o-m*r,l=h*r-i*o,x=i*m-h*n,d=m*a-e*o,u=s*o-h*a,_=h*e-s*m,y=e*r-n*a,p=i*a-s*r,z=s*n-i*e,M=s*c+e*l+a*x;if(0===M)throw new Error("Determinant of the matrix cannot be zero!");const f=1/M;return this.m00=c*f,this.m01=l*f,this.m02=x*f,this.m10=d*f,this.m11=u*f,this.m12=_*f,this.m20=y*f,this.m21=p*f,this.m22=z*f,this}scaleMatrix(t,s,i,h){const e=t.m00,n=t.m01,m=t.m02,a=t.m10,r=t.m11,o=t.m12,c=t.m20,l=t.m21,x=t.m22;return this.m00=s*e,this.m01=i*n,this.m02=h*m,this.m10=s*a,this.m11=i*r,this.m12=h*o,this.m20=s*c,this.m21=i*l,this.m22=h*x,this}translateMatrix(t,s,i,h){const e=t.m00,n=t.m01,m=t.m02,a=t.m10,r=t.m11,o=t.m12,c=t.m20,l=t.m21,x=t.m22;return this.m03=s*e+i*n+h*m,this.m13=s*a+i*r+h*o,this.m23=s*c+i*l+h*x,this}rotateMatrixX(t,s){const i=t.m01,h=t.m02,e=t.m11,n=t.m12,m=t.m21,a=t.m22,r=Math.cos(s),o=Math.sin(s);return this.m01=r*i-o*h,this.m02=r*h+o*i,this.m11=r*e-o*n,this.m12=r*n+o*e,this.m21=r*m-o*a,this.m22=r*a+o*m,this}rotateMatrixY(t,s){const i=t.m00,h=t.m02,e=t.m10,n=t.m12,m=t.m20,a=t.m22,r=Math.cos(s),o=Math.sin(s);return this.m00=r*i+o*h,this.m02=r*h-o*i,this.m10=r*e+o*n,this.m12=r*n-o*e,this.m20=r*m+o*a,this.m22=r*a-o*m,this}rotateMatrixZ(t,s){const i=t.m00,h=t.m01,e=t.m10,n=t.m11,m=t.m20,a=t.m21,r=Math.cos(s),o=Math.sin(s);return this.m00=r*i-o*h,this.m01=r*h+o*i,this.m10=r*e-o*n,this.m11=r*n+o*e,this.m20=r*m-o*a,this.m21=r*a+o*m,this}rotateMatrix(t,s,i,h,e){const n=t.m00,m=t.m01,a=t.m02,r=t.m10,o=t.m11,c=t.m12,l=t.m20,x=t.m21,d=t.m22,u=Math.cos(e),_=Math.sin(e),y=1-u,p=Math.sqrt(s*s+i*i+h*h);if(0==p)throw new Error("axis vector length must be non zero!");const z=1/p,M=z*s,f=z*i,w=z*h,g=M*f,b=M*_,S=M*w,D=f*_,k=f*w,v=w*_,F=u+M*M*y,E=g*y-v,q=S*y+D,V=g*y+v,X=f*f*y+u,Y=k*y-b,Z=S*y-D,I=k*y+b,C=w*w*y+u;return this.m00=r*E+l*q+n*F,this.m01=n*V+l*Y+r*X,this.m02=n*Z+r*I+l*C,this.m10=o*E+x*q+m*F,this.m11=m*V+x*Y+o*X,this.m12=m*Z+o*I+x*C,this.m20=c*E+d*q+a*F,this.m21=a*V+d*Y+c*X,this.m22=a*Z+c*I+d*C,this}transpose(){return this.transposeMatrix(this)}inverse(){return this.inverseMatrix(this)}scale(t,s,i){return this.scaleMatrix(this,t,s,i)}translate(t,s,i){return this.translateMatrix(this,t,s,i)}rotateX(t){return this.rotateMatrixX(this,t)}rotateY(t){return this.rotateMatrixY(this,t)}rotateZ(t){return this.rotateMatrixZ(this,t)}rotate(t,s,i,h){return this.rotateMatrix(this,t,s,i,h)}}class c{static identity(){return new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}static scale(t,s,i){return new c(t,0,0,0,0,s,0,0,0,0,i,0,0,0,0,1)}static translate(t,s,i){return new c(0,0,0,0,0,0,0,0,0,0,0,0,t,s,i,1)}static rotateX(t){const s=Math.cos(t),i=Math.sin(t);return new c(1,0,0,0,0,s,-i,0,0,i,s,0,0,0,0,1)}static rotateY(t){const s=Math.cos(t),i=Math.sin(t);return new c(s,0,i,0,0,1,0,0,-i,0,s,0,0,0,0,1)}static rotateZ(t){const s=Math.cos(t),i=Math.sin(t);return new c(s,-i,0,0,i,s,0,0,0,0,1,0,0,0,0,1)}static rotate(t,s,i,h){const e=Math.cos(h),n=Math.sin(h),m=1-e,a=Math.sqrt(t*t+s*s+i*i);if(0==a)throw new Error("axis vector length must be non zero!");const r=1/a,o=r*t,l=r*s,x=r*i,d=o*l,u=o*n,_=o*x,y=l*n,p=l*x,z=x*n;return new c(e+o*o*m,d*m-z,_*m+y,0,d*m+z,l*l*m+e,p*m-u,0,_*m-y,p*m+u,x*x*m+e,0,0,0,0,1)}constructor(t=1,s=0,i=0,h=0,e=0,n=1,m=0,a=0,r=0,o=0,c=1,l=0,x=0,d=0,u=0,_=1){this.m00=t,this.m01=e,this.m02=r,this.m03=x,this.m10=s,this.m11=n,this.m12=o,this.m13=d,this.m20=i,this.m21=m,this.m22=c,this.m23=u,this.m30=h,this.m31=a,this.m32=l,this.m33=_}clone(){return new c(this.m00,this.m10,this.m20,this.m30,this.m01,this.m11,this.m21,this.m31,this.m02,this.m12,this.m22,this.m32,this.m03,this.m13,this.m23,this.m33)}determinant(){const t=this.m22*this.m33-this.m23*this.m32,s=this.m21*this.m33-this.m23*this.m31,i=this.m21*this.m32-this.m22*this.m31,h=this.m20*this.m33-this.m23*this.m30,e=this.m20*this.m32-this.m22*this.m30,n=this.m20*this.m31-this.m21*this.m30,m=this.m11*t-this.m12*s+this.m13*i,a=this.m10*t-this.m12*h+this.m13*e,r=this.m10*s-this.m11*h+this.m13*n,o=this.m10*i-this.m11*e+this.m12*n;return this.m00*m-this.m01*a+this.m02*r-this.m03*o}isIdentity(){return 1===this.m00&&0===this.m01&&0===this.m02&&0===this.m03&&0===this.m10&&1===this.m11&&0===this.m12&&0===this.m13&&0===this.m20&&0===this.m21&&1===this.m22&&0===this.m23&&0===this.m30&&0===this.m31&&0===this.m32&&1===this.m33}equals(s){return Math.abs(this.m00-s.m00)<=t&&Math.abs(this.m10-s.m10)<=t&&Math.abs(this.m20-s.m20)<=t&&Math.abs(this.m30-s.m30)<=t&&Math.abs(this.m01-s.m01)<=t&&Math.abs(this.m11-s.m11)<=t&&Math.abs(this.m21-s.m21)<=t&&Math.abs(this.m31-s.m31)<=t&&Math.abs(this.m02-s.m02)<=t&&Math.abs(this.m12-s.m12)<=t&&Math.abs(this.m22-s.m22)<=t&&Math.abs(this.m32-s.m32)<=t&&Math.abs(this.m03-s.m03)<=t&&Math.abs(this.m13-s.m13)<=t&&Math.abs(this.m23-s.m23)<=t&&Math.abs(this.m33-s.m33)<=t}identity(){return this.m00=1,this.m01=0,this.m02=0,this.m03=0,this.m10=0,this.m11=1,this.m12=0,this.m13=0,this.m20=0,this.m21=0,this.m22=1,this.m23=0,this.m30=0,this.m31=0,this.m32=0,this.m33=1,this}set(t,s,i,h,e,n,m,a,r,o,c,l,x,d,u,_){return this.m00=t,this.m01=s,this.m02=i,this.m03=h,this.m10=e,this.m11=n,this.m12=m,this.m13=a,this.m20=r,this.m21=o,this.m22=c,this.m23=l,this.m30=x,this.m31=d,this.m32=u,this.m33=_,this}setCols(t,s,i,h,e,n,m,a,r,o,c,l,x,d,u,_){return this.m00=t,this.m01=s,this.m02=i,this.m03=h,this.m10=e,this.m11=n,this.m12=m,this.m13=a,this.m20=r,this.m21=o,this.m22=c,this.m23=l,this.m30=x,this.m31=d,this.m32=u,this.m33=_,this}setRows(t,s,i,h,e,n,m,a,r,o,c,l,x,d,u,_){return this.m00=t,this.m01=e,this.m02=r,this.m03=x,this.m10=s,this.m11=n,this.m12=o,this.m13=d,this.m20=i,this.m21=m,this.m22=c,this.m23=u,this.m30=h,this.m31=a,this.m32=l,this.m33=_,this}copy(t){return this.m00=t.m00,this.m01=t.m01,this.m02=t.m02,this.m03=t.m03,this.m10=t.m10,this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m20=t.m20,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m30=t.m30,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this}transposeMatrix(t){const s=t.m00,i=t.m01,h=t.m02,e=t.m03,n=t.m10,m=t.m11,a=t.m12,r=t.m13,o=t.m20,c=t.m21,l=t.m22,x=t.m23,d=t.m30,u=t.m31,_=t.m32,y=t.m33;return this.m00=s,this.m01=n,this.m02=o,this.m03=d,this.m10=i,this.m11=m,this.m12=c,this.m13=u,this.m20=h,this.m21=a,this.m22=l,this.m23=_,this.m30=e,this.m31=r,this.m32=x,this.m33=y,this}mulMatrices(t,s){const i=t.m00,h=t.m01,e=t.m02,n=t.m03,m=t.m10,a=t.m11,r=t.m12,o=t.m13,c=t.m20,l=t.m21,x=t.m22,d=t.m23,u=t.m30,_=t.m31,y=t.m32,p=t.m33,z=s.m00,M=s.m01,f=s.m02,w=s.m03,g=s.m10,b=s.m11,S=s.m12,D=s.m13,k=s.m20,v=s.m21,F=s.m22,E=s.m23,q=s.m30,V=s.m31,X=s.m32,Y=s.m33;return this.m00=i*z+m*M+c*f+u*w,this.m01=i*g+m*b+c*S+u*D,this.m02=i*k+m*v+c*F+u*E,this.m03=i*q+m*V+c*X+u*Y,this.m10=h*z+a*M+l*f+_*w,this.m11=h*g+a*b+l*S+_*D,this.m12=h*k+a*v+l*F+_*E,this.m13=h*q+a*V+l*X+_*Y,this.m20=e*z+r*M+x*f+y*w,this.m21=e*g+r*b+x*S+y*D,this.m22=e*k+r*v+x*F+y*E,this.m23=e*q+r*V+x*X+y*Y,this.m30=n*z+o*M+d*f+p*w,this.m31=n*g+o*b+d*S+p*D,this.m32=n*k+o*v+d*F+p*E,this.m33=n*q+o*V+d*X+p*Y,this}inverseMatrix(t){const s=t.m00,i=t.m01,h=t.m02,e=t.m03,n=t.m10,m=t.m11,a=t.m12,r=t.m13,o=t.m20,c=t.m21,l=t.m22,x=t.m23,d=t.m30,u=t.m31,_=t.m32,y=t.m33,p=l*y-x*_,z=a*y-x*u,M=a*_-l*u,f=h*y-x*d,w=h*_-l*d,g=h*u-c*d,b=o*r-e*a,S=n*r-e*m,D=n*a-h*m,k=s*r-e*n,v=s*a-h*n,F=s*m-i*n,E=m*p-a*z+r*M,q=c*f-r*w-n*p,V=i*z-m*f+r*g,X=m*w-a*g-n*M,Y=o*z-e*M-i*p,Z=s*p-h*f+e*w,I=n*f-e*g-s*z,C=s*M-i*w+h*g,A=r*b-_*S+y*D,T=x*k-y*v-d*b,U=e*S-u*k+y*F,B=r*v-_*F-d*D,O=l*S-x*D-c*b,P=h*b-l*k+x*v,j=a*k-x*F-o*S,$=h*D-c*v+l*F,L=s*E+i*q+h*V+e*X;if(0===L)throw new Error("Determinant of the cofactor matrix cannot be zero!");const N=1/L;return this.m00=E*N,this.m01=Y*N,this.m02=A*N,this.m03=O*N,this.m10=q*N,this.m11=Z*N,this.m12=T*N,this.m13=P*N,this.m20=V*N,this.m21=I*N,this.m22=U*N,this.m23=j*N,this.m30=X*N,this.m31=C*N,this.m32=B*N,this.m33=$*N,this}scaleMatrix(t,s,i,h){const e=t.m00,n=t.m01,m=t.m02,a=t.m10,r=t.m11,o=t.m12,c=t.m20,l=t.m21,x=t.m22,d=t.m30,u=t.m31,_=t.m32;return this.m00=s*e,this.m01=i*n,this.m02=h*m,this.m10=s*a,this.m11=i*r,this.m12=h*o,this.m20=s*c,this.m21=i*l,this.m22=h*x,this.m30=s*d,this.m31=i*u,this.m32=h*_,this}translateMatrix(t,s,i,h){const e=t.m00,n=t.m01,m=t.m02,a=t.m03,r=t.m10,o=t.m11,c=t.m12,l=t.m13,x=t.m20,d=t.m21,u=t.m22,_=t.m23,y=t.m30,p=t.m31,z=t.m32,M=t.m33;return this.m00=e+s*a,this.m10=r+s*l,this.m20=x+s*_,this.m30=y+s*M,this.m01=n+i*a,this.m11=o+i*l,this.m21=d+i*_,this.m31=p+i*M,this.m02=m+h*a,this.m12=c+h*l,this.m22=u+h*_,this.m32=z+h*M,this.m03=a,this.m13=l,this.m23=_,this.m33=M,this}rotateMatrixX(t,s){const i=t.m01,h=t.m02,e=t.m11,n=t.m12,m=t.m21,a=t.m22,r=t.m31,o=t.m32,c=Math.cos(s),l=Math.sin(s);return this.m01=c*i-l*h,this.m02=c*h+l*i,this.m11=c*e-l*n,this.m12=c*n+l*e,this.m21=c*m-l*a,this.m22=c*a+l*m,this.m31=c*r-l*o,this.m32=c*o+l*r,this}rotateMatrixY(t,s){const i=t.m00,h=t.m02,e=t.m10,n=t.m12,m=t.m20,a=t.m22,r=t.m30,o=t.m32,c=Math.cos(s),l=Math.sin(s);return this.m00=c*i+l*h,this.m02=c*h-l*i,this.m10=c*e+l*n,this.m12=c*n-l*e,this.m20=c*m+l*a,this.m22=c*a-l*m,this.m30=c*r+l*o,this.m32=c*o-l*r,this}rotateMatrixZ(t,s){const i=t.m00,h=t.m01,e=t.m10,n=t.m11,m=t.m20,a=t.m21,r=t.m30,o=t.m31,c=Math.cos(s),l=Math.sin(s);return this.m00=c*i-l*h,this.m01=c*h+l*i,this.m10=c*e-l*n,this.m11=c*n+l*e,this.m20=c*m-l*a,this.m21=c*a+l*m,this.m30=c*r-l*o,this.m31=c*o+l*r,this}rotateMatrix(t,s,i,h,e){const n=t.m00,m=t.m01,a=t.m02,r=t.m03,o=t.m10,c=t.m11,l=t.m12,x=t.m13,d=t.m20,u=t.m21,_=t.m22,y=t.m23,p=Math.cos(e),z=Math.sin(e),M=1-p,f=Math.sqrt(s*s+i*i+h*h);if(0==f)throw new Error("axis vector length must be non zero!");const w=1/f,g=w*s,b=w*i,S=w*h,D=g*b,k=g*z,v=g*S,F=b*z,E=b*S,q=S*z,V=p+g*g*M,X=D*M-q,Y=v*M+F,Z=D*M+q,I=b*b*M+p,C=E*M-k,A=v*M-F,T=E*M+k,U=S*S*M+p;return this.m00=o*X+d*Y+n*V,this.m01=n*Z+d*C+o*I,this.m02=n*A+o*T+d*U,this.m10=c*X+u*Y+m*V,this.m11=m*Z+u*C+c*I,this.m12=m*A+c*T+u*U,this.m20=l*X+_*Y+a*V,this.m21=a*Z+_*C+l*I,this.m22=a*A+l*T+_*U,this.m30=x*X+y*Y+r*V,this.m31=r*Z+y*C+x*I,this.m32=r*A+x*T+y*U,this}transpose(){return this.transposeMatrix(this)}inverse(){return this.inverseMatrix(this)}scale(t,s,i){return this.scaleMatrix(this,t,s,i)}translate(t,s,i){return this.translateMatrix(this,t,s,i)}rotateX(t){return this.rotateMatrixX(this,t)}rotateY(t){return this.rotateMatrixY(this,t)}rotateZ(t){return this.rotateMatrixZ(this,t)}rotate(t,s,i,h){return this.rotateMatrix(this,t,s,i,h)}}function l(t,s,i){return t>i?i:t<s?s:t}function x(t,s){return t<s?x(s,t):Math.abs(s)<.001?t:x(s,t-Math.floor(t/s)*s)}function d(t,s){return t*s/x(t,s)}function u(t,s,i){return(s-t)*i+t}function _(t,s,i){return x(t,x(s,i))}function y(t,s,i,h){if(t==s&&t==i){const s=t/h;return Math.floor(s)/s*h}const e=x(t,x(s,i));return h<e?Math.min(Math.floor(e/h),1)*h:Math.max(Math.floor(h/e),1)*e}function p(t,s,i,h){return y(t,s,i,Math.max(t,s,i)/h)}function z(t,s,i){return Math.sqrt(t*t+s*s+i*i)}function M(t,s,i,h,e,n){const m=h-t,a=e-s,r=n-i;return m*m+a*a+r*r}class f{constructor(t=new h(0,0,0),s=new h(0,0,0),n=new e(0,0,0,1),m=new i(0,0),a=0){this.position=t,this.normal=s,this.colour=n,this.texture_coords=m,this.texture_id=a}}class w{constructor(t=[],s=[]){this.vertices=t,this.indices=s}}class g{constructor(t=[],s=new a,i=null){this.indices=t,this.plane=s,this.colour=i}}class b{constructor(t=[],s=[]){this.vertices=t,this.faces=s}}function S(t,s,i,h){let e=t.subdivision_count<s.subdivision_count?t:s;return e=e.subdivision_count<i.subdivision_count?e:i,e=e.subdivision_count<h.subdivision_count?e:h,e}function D(t,s,i,h,e,n,m,a,r,o){const c=(a-s)/(e-s),l=1-c,x=(r-i)/(n-i),d=1-x,u=(o-h)/(m-h),_=1-u,y=t.calculateSignedDistance(s,i,h),p=t.calculateSignedDistance(e,i,h),z=t.calculateSignedDistance(e,n,h),M=t.calculateSignedDistance(s,n,h),f=t.calculateSignedDistance(s,i,m),w=t.calculateSignedDistance(e,i,m),g=t.calculateSignedDistance(e,n,m);return((y*l+p*c)*d+(M*l+z*c)*x)*_+((f*l+w*c)*d+(t.calculateSignedDistance(s,n,m)*l+g*c)*x)*u}class k{constructor(t,s,i,h,e,n,m,a){this.x0=t,this.y0=s,this.z0=i,this.x1=e,this.y1=n,this.z1=m,this.sample0=h,this.sample1=a}set(t,s,i,h,e,n,m,a){this.x0=t,this.y0=s,this.z0=i,this.x1=e,this.y1=n,this.z1=m,this.sample0=h,this.sample1=a}}class v{constructor(t,s,i,h,e,n,m=1){this.kind=4,this.min_x=t,this.min_y=s,this.min_z=i,this.max_x=h,this.max_y=e,this.max_z=n,this.subdivision_count=m,this.node000=null,this.node100=null,this.node110=null,this.node010=null,this.node001=null,this.node101=null,this.node111=null,this.node011=null,this.sample000=null,this.sample100=null,this.sample110=null,this.sample010=null,this.sample001=null,this.sample101=null,this.sample111=null,this.sample011=null}sampleSignedDistanceField(t,s=null){const i=this.min_x,h=this.max_x,e=(h+i)/2,n=this.min_y,m=this.max_y,a=(m+n)/2,r=this.min_z,o=this.max_z,c=(o+r)/2,l=t.calculateSignedDistance(e,a,c),x=t.calculateSignedDistance(h,a,c),d=t.calculateSignedDistance(i,a,c),u=t.calculateSignedDistance(e,n,c),_=t.calculateSignedDistance(e,m,c),y=t.calculateSignedDistance(e,a,o),p=t.calculateSignedDistance(e,a,r);if(null!=s){const z=D(t,i,n,r,h,m,o,e,a,c),M=D(t,i,n,r,h,m,o,h,a,c),f=D(t,i,n,r,h,m,o,i,a,c),w=D(t,i,n,r,h,m,o,e,n,c),g=D(t,i,n,r,h,m,o,e,m,c),b=D(t,i,n,r,h,m,o,e,a,o),S=D(t,i,n,r,h,m,o,e,a,r);if(Math.abs(l-z)<=s&&Math.abs(x-M)<=s&&Math.abs(d-f)<=s&&Math.abs(u-w)<=s&&Math.abs(_-g)<=s&&Math.abs(y-b)<=s&&Math.abs(p-S)<=s){const s=new F(i,n,r,h,m,o);return s.sample000=t.calculateSignedDistance(i,n,r),s.sample001=t.calculateSignedDistance(i,n,o),s.sample010=t.calculateSignedDistance(i,m,r),s.sample011=t.calculateSignedDistance(i,m,o),s.sample100=t.calculateSignedDistance(h,n,r),s.sample101=t.calculateSignedDistance(h,n,o),s.sample110=t.calculateSignedDistance(h,m,r),s.sample111=t.calculateSignedDistance(h,m,o),s.sampleSignedDistanceField(t)}}if(1==this.subdivision_count)this.node000=new F(i,n,r,e,a,c,0),this.node001=new F(i,n,c,e,a,o,0),this.node010=new F(i,a,r,e,m,c,0),this.node011=new F(i,a,c,e,m,o,0),this.node100=new F(e,n,r,h,a,c,0),this.node101=new F(e,n,c,h,a,o,0),this.node110=new F(e,a,r,h,m,c,0),this.node111=new F(e,a,c,h,m,o,0);else{const t=this.subdivision_count-1;this.node000=new v(i,n,r,e,a,c,t),this.node001=new v(i,n,c,e,a,o,t),this.node010=new v(i,a,r,e,m,c,t),this.node011=new v(i,a,c,e,m,o,t),this.node100=new v(e,n,r,h,a,c,t),this.node101=new v(e,n,c,h,a,o,t),this.node110=new v(e,a,r,h,m,c,t),this.node111=new v(e,a,c,h,m,o,t)}const z=t.calculateSignedDistance(e,n,r),M=t.calculateSignedDistance(e,m,r),f=t.calculateSignedDistance(e,m,o),w=t.calculateSignedDistance(e,n,o),g=t.calculateSignedDistance(i,a,r),b=t.calculateSignedDistance(h,a,r),S=t.calculateSignedDistance(h,a,o),k=t.calculateSignedDistance(i,a,o),E=t.calculateSignedDistance(i,n,c),q=t.calculateSignedDistance(h,n,c),V=t.calculateSignedDistance(h,m,c),X=t.calculateSignedDistance(i,m,c);this.sample000??=t.calculateSignedDistance(i,n,r),this.sample001??=t.calculateSignedDistance(i,n,o),this.sample010??=t.calculateSignedDistance(i,m,r),this.sample011??=t.calculateSignedDistance(i,m,o),this.sample100??=t.calculateSignedDistance(h,n,r),this.sample101??=t.calculateSignedDistance(h,n,o),this.sample110??=t.calculateSignedDistance(h,m,r),this.sample111??=t.calculateSignedDistance(h,m,o),this.node000.sample000=this.sample000,this.node001.sample001=this.sample001,this.node010.sample010=this.sample010,this.node011.sample011=this.sample011,this.node100.sample100=this.sample100,this.node101.sample101=this.sample101,this.node110.sample110=this.sample110,this.node111.sample111=this.sample111,this.node000.sample111=l,this.node001.sample110=l,this.node010.sample101=l,this.node011.sample100=l,this.node100.sample011=l,this.node101.sample010=l,this.node110.sample001=l,this.node111.sample000=l,this.node100.sample111=x,this.node101.sample110=x,this.node110.sample101=x,this.node111.sample100=x,this.node000.sample011=d,this.node001.sample010=d,this.node010.sample001=d,this.node011.sample000=d,this.node010.sample111=_,this.node011.sample110=_,this.node110.sample011=_,this.node111.sample010=_,this.node000.sample101=u,this.node001.sample100=u,this.node100.sample001=u,this.node101.sample000=u,this.node001.sample111=y,this.node011.sample101=y,this.node101.sample011=y,this.node111.sample001=y,this.node000.sample110=p,this.node010.sample100=p,this.node100.sample010=p,this.node110.sample000=p,this.node100.sample000=this.node000.sample100=z,this.node110.sample010=this.node010.sample110=M,this.node111.sample011=this.node011.sample111=f,this.node101.sample001=this.node001.sample101=w,this.node010.sample000=this.node000.sample010=g,this.node110.sample100=this.node100.sample110=b,this.node111.sample101=this.node101.sample111=S,this.node011.sample001=this.node001.sample011=k,this.node001.sample000=this.node000.sample001=E,this.node101.sample100=this.node100.sample101=q,this.node111.sample110=this.node110.sample111=V,this.node011.sample010=this.node010.sample011=X,this.sample000=null,this.sample001=null,this.sample010=null,this.sample011=null,this.sample100=null,this.sample101=null,this.sample110=null,this.sample111=null,this.node000=this.node000.sampleSignedDistanceField(t,s),this.node001=this.node001.sampleSignedDistanceField(t,s),this.node010=this.node010.sampleSignedDistanceField(t,s),this.node011=this.node011.sampleSignedDistanceField(t,s),this.node100=this.node100.sampleSignedDistanceField(t,s),this.node101=this.node101.sampleSignedDistanceField(t,s),this.node110=this.node110.sampleSignedDistanceField(t,s),this.node111=this.node111.sampleSignedDistanceField(t,s);const Y=this.node000.kind|this.node100.kind|this.node110.kind|this.node010.kind|this.node001.kind|this.node101.kind|this.node111.kind|this.node011.kind;return 1==Y?yt:2==Y?pt:this}}class F{constructor(t,s,i,h,e,n){this.kind=8,this.min_x=t,this.min_y=s,this.min_z=i,this.max_x=h,this.max_y=e,this.max_z=n,this.sample000=0,this.sample100=0,this.sample110=0,this.sample010=0,this.sample001=0,this.sample101=0,this.sample111=0,this.sample011=0,this.surface_vertex=null}getNodeState(){let t=0;return this.sample000<0&&(t|=1),this.sample001<0&&(t|=2),this.sample010<0&&(t|=4),this.sample011<0&&(t|=8),this.sample100<0&&(t|=16),this.sample101<0&&(t|=32),this.sample110<0&&(t|=64),this.sample111<0&&(t|=128),t}sampleSignedDistanceField(t){this.min_x,this.max_x,this.min_y,this.max_y,this.min_z,this.max_z;const s=this.getNodeState();if(255==s)return yt;if(0==s)return pt;const i=this.calculateSurfacePosition(),h=t.calculateGradient(i.x,i.y,i.z).normalize();return this.surface_vertex=new f(i,h),this}calculateSurfacePosition(){const t=this.getTemporaryEdges();let s=0,i=0,e=0,n=0;for(let h=0;h<t.length;++h){const m=t[h];if(m.sample0<0!=m.sample1<0){const t=Math.abs(m.sample0)/(Math.abs(m.sample0)+Math.abs(m.sample1));s+=(m.x1-m.x0)*t+m.x0,i+=(m.y1-m.y0)*t+m.y0,e+=(m.z1-m.z0)*t+m.z0,n+=1}}if(0==n)return null;const m=1/n;return new h(s*m,i*m,e*m)}getTemporaryEdges(){const t=this.min_x,s=this.min_y,i=this.min_z,h=this.max_x,e=this.max_y,n=this.max_z;return wt[0].set(t,s,i,this.sample000,h,s,i,this.sample100),wt[1].set(t,e,i,this.sample010,h,e,i,this.sample110),wt[2].set(t,s,n,this.sample001,h,s,n,this.sample101),wt[3].set(t,e,n,this.sample011,h,e,n,this.sample111),wt[4].set(t,s,i,this.sample000,t,e,i,this.sample010),wt[5].set(h,s,i,this.sample100,h,e,i,this.sample110),wt[6].set(t,s,n,this.sample001,t,e,n,this.sample011),wt[7].set(h,s,n,this.sample101,h,e,n,this.sample111),wt[8].set(t,s,i,this.sample000,t,s,n,this.sample001),wt[9].set(h,s,i,this.sample100,h,s,n,this.sample101),wt[10].set(h,e,i,this.sample110,h,e,n,this.sample111),wt[11].set(t,e,i,this.sample010,t,e,n,this.sample011),wt}}class E{constructor(){this.kind=2}}class q{constructor(){this.kind=1}}class V{constructor(){this.vertices=[],this.indices=[]}getMesh(){return new w(this.vertices,this.indices)}clear(){this.vertices=[],this.indices=[]}buildMesh(...t){for(let s=0;s<t.length;++s)this.processCell(t[s]);return new w(this.vertices,this.indices)}addTriangle(t,s,i,h=!1){const e=this.vertices.length;h?this.indices.push(e+2,e+1,e+0):this.indices.push(e+0,e+1,e+2),this.vertices.push(t.surface_vertex,s.surface_vertex,i.surface_vertex)}addQuad(t,s,i,h,e=!1){if(t==s)return this.addTriangle(t,i,h,e);if(t==i)throw new Error("Invalid quad winding!");if(t==h)return this.addTriangle(t,s,i,e);if(s==i)return this.addTriangle(t,s,h,e);if(s==h)throw new Error("Invalid quad winding!");if(i==h)return this.addTriangle(t,s,i,e);const n=this.vertices.length;e?this.indices.push(n+3,n+2,n+0,n+2,n+1,n+0):this.indices.push(n+0,n+1,n+2,n+0,n+2,n+3),this.vertices.push(t.surface_vertex,s.surface_vertex,i.surface_vertex,h.surface_vertex)}processCell(t){4==t.kind&&(this.processCell(t.node000),this.processCell(t.node001),this.processCell(t.node010),this.processCell(t.node011),this.processCell(t.node100),this.processCell(t.node101),this.processCell(t.node110),this.processCell(t.node111),this.processFaceX(t.node000,t.node100),this.processFaceX(t.node010,t.node110),this.processFaceX(t.node011,t.node111),this.processFaceX(t.node001,t.node101),this.processFaceY(t.node000,t.node010),this.processFaceY(t.node100,t.node110),this.processFaceY(t.node101,t.node111),this.processFaceY(t.node001,t.node011),this.processFaceZ(t.node000,t.node001),this.processFaceZ(t.node100,t.node101),this.processFaceZ(t.node110,t.node111),this.processFaceZ(t.node010,t.node011),this.processEdgeX(t.node000,t.node010,t.node011,t.node001),this.processEdgeX(t.node100,t.node110,t.node111,t.node101),this.processEdgeY(t.node000,t.node100,t.node101,t.node001),this.processEdgeY(t.node010,t.node110,t.node111,t.node011),this.processEdgeZ(t.node000,t.node100,t.node110,t.node010),this.processEdgeZ(t.node001,t.node101,t.node111,t.node011))}processFaceX(t,s){const i=t.kind|s.kind;if(3&i||!(4&i))return;let h=t,e=t,n=s,m=s,a=t,r=t,o=s,c=s;4==t.kind&&(h=t.node100,e=t.node110,a=t.node101,r=t.node111),4==s.kind&&(n=s.node000,m=s.node010,o=s.node001,c=s.node011),this.processFaceX(h,n),this.processFaceX(e,m),this.processFaceX(r,c),this.processFaceX(a,o),this.processEdgeY(h,n,o,a),this.processEdgeY(e,m,c,r),this.processEdgeZ(h,n,m,e),this.processEdgeZ(a,o,c,r)}processFaceY(t,s){const i=t.kind|s.kind;if(3&i||!(4&i))return;let h=t,e=t,n=s,m=s,a=t,r=t,o=s,c=s;4==t.kind&&(h=t.node010,e=t.node110,a=t.node011,r=t.node111),4==s.kind&&(n=s.node000,m=s.node100,o=s.node001,c=s.node101),this.processFaceY(h,n),this.processFaceY(e,m),this.processFaceY(r,c),this.processFaceY(a,o),this.processEdgeX(h,n,o,a),this.processEdgeX(e,m,c,r),this.processEdgeZ(h,e,m,n),this.processEdgeZ(a,r,c,o)}processFaceZ(t,s){const i=t.kind|s.kind;if(3&i||!(4&i))return;let h=t,e=t,n=s,m=s,a=t,r=t,o=s,c=s;4==t.kind&&(h=t.node001,e=t.node101,a=t.node011,r=t.node111),4==s.kind&&(n=s.node000,m=s.node100,o=s.node010,c=s.node110),this.processFaceZ(h,n),this.processFaceZ(e,m),this.processFaceZ(r,c),this.processFaceZ(a,o),this.processEdgeX(h,a,o,n),this.processEdgeX(e,r,c,m),this.processEdgeY(h,e,m,n),this.processEdgeY(a,r,c,o)}processEdgeX(t,s,i,h){const e=t.kind|s.kind|i.kind|h.kind;if(!(3&e))if(4&e){const e=4==t.kind?t.node011:t,n=4==t.kind?t.node111:t,m=4==s.kind?s.node001:s,a=4==s.kind?s.node101:s,r=4==h.kind?h.node010:h,o=4==h.kind?h.node110:h,c=4==i.kind?i.node000:i,l=4==i.kind?i.node100:i;this.processEdgeX(e,m,c,r),this.processEdgeX(n,a,l,o)}else{let e=!1;switch(S(t,s,i,h)){case t:e=t.sample111<t.sample011;break;case s:e=s.sample101<s.sample001;break;case i:e=i.sample100<i.sample000;break;case h:e=h.sample110<h.sample010}this.addQuad(t,s,i,h,e)}}processEdgeY(t,s,i,h){const e=t.kind|s.kind|i.kind|h.kind;if(!(3&e))if(4&e){const e=4==t.kind?t.node101:t,n=4==t.kind?t.node111:t,m=4==s.kind?s.node001:s,a=4==s.kind?s.node011:s,r=4==h.kind?h.node100:h,o=4==h.kind?h.node110:h,c=4==i.kind?i.node000:i,l=4==i.kind?i.node010:i;this.processEdgeY(e,m,c,r),this.processEdgeY(n,a,l,o)}else{let e=!1;switch(S(t,s,i,h)){case t:e=t.sample101<t.sample111;break;case s:e=s.sample001<s.sample011;break;case i:e=i.sample000<i.sample010;break;case h:e=h.sample100<h.sample110}this.addQuad(t,s,i,h,e)}}processEdgeZ(t,s,i,h){const e=t.kind|s.kind|i.kind|h.kind;if(!(3&e))if(4&e){const e=4==t.kind?t.node110:t,n=4==t.kind?t.node111:t,m=4==s.kind?s.node010:s,a=4==s.kind?s.node011:s,r=4==h.kind?h.node100:h,o=4==h.kind?h.node101:h,c=4==i.kind?i.node000:i,l=4==i.kind?i.node001:i;this.processEdgeZ(e,m,c,r),this.processEdgeZ(n,a,l,o)}else{let e=!1;switch(S(t,s,i,h)){case t:e=t.sample111<t.sample110;break;case s:e=s.sample011<s.sample010;break;case i:e=i.sample001<i.sample000;break;case h:e=h.sample101<h.sample100}this.addQuad(t,s,i,h,e)}}}function X(t,s,i,h=null){return new v(s.min_x,s.min_y,s.min_z,s.max_x,s.max_y,s.max_z,i).sampleSignedDistanceField(t,h)}function Y(t,s=t.bounding_box,i=8,h=5e-4){const e=new v(s.min_x,s.min_y,s.min_z,s.max_x,s.max_y,s.max_z,i).sampleSignedDistanceField(t,h),n=new V;return n.processCell(e),n.getMesh()}class Z{constructor(t){this.view=new DataView(t),this.offset=0}setOffset(t){this.offset=t}writeInt8(t){this.view.setInt8(this.offset,t),this.offset+=1}writeUint8(t){this.view.setUint8(this.offset,t),this.offset+=1}writeInt16(t,s){this.view.setInt16(this.offset,t,s),this.offset+=2}writeUint16(t,s){this.view.setUint16(this.offset,t,s),this.offset+=2}writeInt32(t,s){this.view.setInt32(this.offset,t,s),this.offset+=4}writeUint32(t,s){this.view.setUint32(this.offset,t,s),this.offset+=4}writeFloat32(t,s){this.view.setFloat32(this.offset,t,s),this.offset+=4}writeFloat64(t,s){this.view.setFloat64(this.offset,t,s),this.offset+=8}writeBuffer(t){new Uint8Array(this.view.buffer).set(new Uint8Array(t),this.offset),this.offset+=t.byteLength}}function I(t){if(t instanceof w==0)throw new Error("input mesh must be a 'TriangleMesh'!");const s=t.indices.length/3,i=new ArrayBuffer(84+50*s),h=new Z(i);h.setOffset(80),h.writeUint32(s,!0);for(let s=0;s<t.indices.length;s+=3){const i=t.vertices[t.indices[s+0]].position,e=t.vertices[t.indices[s+1]].position,n=t.vertices[t.indices[s+2]].position;zt.fromVectors(i,e,n),h.writeFloat32(zt.normal_x,!0),h.writeFloat32(zt.normal_y,!0),h.writeFloat32(zt.normal_z,!0),h.writeFloat32(i.x,!0),h.writeFloat32(i.y,!0),h.writeFloat32(i.z,!0),h.writeFloat32(e.x,!0),h.writeFloat32(e.y,!0),h.writeFloat32(e.z,!0),h.writeFloat32(n.x,!0),h.writeFloat32(n.y,!0),h.writeFloat32(n.z,!0),h.writeUint16(0,!0)}return new Uint8Array(i)}function C(t){if(t instanceof w==0)throw new Error("input mesh must be a 'TriangleMesh'!");let s="";for(let i=0;i<t.vertices.length;++i){const h=t.vertices[i].position;s+=`v ${h.x}, ${h.y}, ${h.z}\n`}for(let i=0;i<t.indices.length;i+=3){s+=`f ${t.indices[i+0]+1}, ${t.indices[i+1]+1}, ${t.indices[i+2]+1}\n`}return s}class A{calculateSignedDistance(t,s,i){throw new Error("calculateSignedDistance is unimplemented!")}calculateGradient(t,s,i,e=new h){const n=1e-5,m=this.calculateSignedDistance(t+n,s-n,i-n),a=this.calculateSignedDistance(t-n,s-n,i+n),r=this.calculateSignedDistance(t-n,s+n,i-n),o=this.calculateSignedDistance(t+n,s+n,i+n);return e.set(+m-a-r+o,-m-a+r+o,-m+a-r+o).normalize()}raycast(s,i,h,e,n,m,a=1/0){let r=0;for(let o=0;o<256&&r<a;++o){const a=this.calculateSignedDistance(s+r*e,i+r*n,h+r*m);if(a<t)return r;r+=a}return null}raycastIntersection(t,s,i,e,n,m,a=new h){const r=this.calculateSignedDistance(t,s,i);if(r<0==this.calculateSignedDistance(e,n,m)<0)return null;r<0&&([t,s,i,e,n,m]=[e,n,m,t,s,i]);const o=e-t,c=n-s,l=m-i,x=Math.sqrt(o*o+c*c+l*l);if(0==x)return null;const d=1/x,u=o*d,_=c*d,y=l*d,p=this.raycast(t,s,i,u,_,y,x);return null!=p?a.set(t+p*u,s+p*_,i+p*y):null}_raycastIntersection(t,s,i,e,n,m,a=new h){const r=e-t,o=n-s,c=m-i,l=1/Math.sqrt(r*r+o*o+c*c),x=r*l,d=o*l,u=c*l;for(let h=0;h<256;++h){const h=this.calculateSignedDistance(t,s,i),e=Math.abs(h);t+=x*e,s+=d*e,i+=u*e}return null}transform(t=new c){return new $(this,t)}rotateX(t=0){return this.transform(Mt.identity().rotateX(t))}rotateY(t=0){return this.transform(Mt.identity().rotateY(t))}rotateZ(t=0){return this.transform(Mt.identity().rotateZ(t))}twist(t=0){return new L(this,t)}shell(t=1){return new N(this,t)}offset(t=1){return new Q(this,t)}union(...t){return new G([this,...t])}difference(...t){return new R([this,...t])}intersection(...t){return new H([this,...t])}unionSmooth(t=0,...s){return new J(t,[this,...s])}differenceSmooth(t=0,...s){return new K(t,[this,...s])}intersectionSmooth(t=0,...s){return new W(t,[this,...s])}translate(t=0,s=0,i=0){return this.transform(Mt.identity().translate(t,s,i))}rotate(t=0,s=0,i=1,h=0){return this.transform(Mt.identity().rotate(t,s,i,h))}}class T extends A{constructor(t,s,i,h=0){super(),this.corner_radius=h,this.half_size_x=.5*t,this.half_size_y=.5*s,this.half_size_z=.5*i,this.bounding_box=new m(-this.half_size_x,-this.half_size_y,-this.half_size_z,this.half_size_x,this.half_size_y,this.half_size_z)}calculateSignedDistance(t,s,i){const h=Math.abs(t)-this.half_size_x+this.corner_radius,e=Math.abs(s)-this.half_size_y+this.corner_radius,n=Math.abs(i)-this.half_size_z+this.corner_radius,m=Math.max(h,0),a=Math.max(e,0),r=Math.max(n,0),o=Math.min(Math.max(h,e,n),0);return Math.sqrt(m*m+a*a+r*r)+o-this.corner_radius}}class U extends A{constructor(t,s,i,h=5){super(),this.frame_size=h,this.half_size_x=.5*t,this.half_size_y=.5*s,this.half_size_z=.5*i,this.bounding_box=new m(-this.half_size_x,-this.half_size_y,-this.half_size_z,this.half_size_x,this.half_size_y,this.half_size_z)}calculateSignedDistance(t,s,i){const h=Math.abs(t)-this.half_size_x,e=Math.abs(s)-this.half_size_y,n=Math.abs(i)-this.half_size_z,m=Math.abs(h+this.frame_size)-this.frame_size,a=Math.abs(e+this.frame_size)-this.frame_size,r=Math.abs(n+this.frame_size)-this.frame_size;return Math.min(z(Math.max(m,0),Math.max(a,0),Math.max(n,0))+Math.min(Math.max(m,a,n),0),z(Math.max(h,0),Math.max(a,0),Math.max(r,0))+Math.min(Math.max(h,a,r),0),z(Math.max(m,0),Math.max(e,0),Math.max(r,0))+Math.min(Math.max(m,e,r),0))}}class B extends A{constructor(t=5){super(),this.radius=t,this.bounding_box=new m(-t,-t,-t,t,t,t)}calculateSignedDistance(t,s,i){return Math.sqrt(t*t+s*s+i*i)-this.radius}}class O extends A{constructor(t=10,s=5){super();const i=t+s;this.inner_radius=s,this.outer_radius=t,this.bounding_box=new m(-i,-i,-s,i,i,s)}calculateSignedDistance(t,s,i){const h=Math.sqrt(t*t+s*s)-this.outer_radius;return Math.sqrt(h*h+i*i)-this.inner_radius}}class P extends A{constructor(t=10,s=20){super(),this.radius=t,this.half_height=.5*s,this.bounding_box=new m(-this.radius,-this.radius,-this.half_height,this.radius,this.radius,this.half_height)}calculateSignedDistance(t,s,i){const h=Math.abs(Math.sqrt(t*t+s*s))-this.radius,e=Math.abs(i)-this.half_height,n=Math.max(h,0),m=Math.max(e,0);return Math.min(Math.max(h,e),0)+Math.sqrt(n*n+m*m)}}class j extends A{constructor(t=new a(0,0,1,0)){super(),this.plane=t,this.bounding_box=new m(1/0,1/0,1/0,-1/0,-1/0,-1/0)}calculateSignedDistance(t,s,i){return this.plane.distanceToPoint(t,s,i)}}class $ extends A{constructor(t,s=new c){super(),this.matrix=s.clone(),this.inverse_matrix=this.matrix.clone().inverse(),this.bounding_box=t.bounding_box.clone().transformMatrix4(this.matrix),this.field=t}calculateSignedDistance(t,s,i){return ft.set(t,s,i).transformMatrix4(this.inverse_matrix),this.field.calculateSignedDistance(ft.x,ft.y,ft.z)}}class L extends A{constructor(t,s){super(),this.field=t,this.k=s/(t.bounding_box.max_z-t.bounding_box.min_z);const i=Math.min(t.bounding_box.min_x,t.bounding_box.min_y),h=Math.max(t.bounding_box.max_x,t.bounding_box.max_y);this.bounding_box=new m(i,i,t.bounding_box.min_z,h,h,t.bounding_box.max_z)}calculateSignedDistance(t,s,i){const h=Math.cos(i*this.k),e=Math.sin(i*this.k),n=t*h-s*e,m=t*e+s*h;return this.field.calculateSignedDistance(n,m,i)}}class N extends A{constructor(t,s){super(),this.field=t,this.half_thickness=.5*s,this.bounding_box=t.bounding_box.clone().grow(this.half_thickness)}calculateSignedDistance(t,s,i){return Math.abs(this.field.calculateSignedDistance(t,s,i))-this.half_thickness}}class Q extends A{constructor(t,s){super(),this.field=t,this.distance=s,this.bounding_box=t.bounding_box.clone().grow(this.distance)}calculateSignedDistance(t,s,i){return this.field.calculateSignedDistance(t,s,i)-this.distance}}class G extends A{constructor(t=[]){super(),this.fields=t,this.bounding_box=this.fields[0].bounding_box.clone();for(let t=1;t<this.fields.length;++t)this.bounding_box.union(this.fields[t].bounding_box)}calculateSignedDistance(t,s,i){let h=this.fields[0].calculateSignedDistance(t,s,i);for(let e=1;e<this.fields.length;++e)h=Math.min(h,this.fields[e].calculateSignedDistance(t,s,i));return h}}class R extends A{constructor(t=[]){super(),this.fields=t,this.bounding_box=this.fields[0].bounding_box.clone()}calculateSignedDistance(t,s,i){let h=this.fields[0].calculateSignedDistance(t,s,i);for(let e=1;e<this.fields.length;++e)h=Math.max(h,-this.fields[e].calculateSignedDistance(t,s,i));return h}}class H extends A{constructor(t=[]){super(),this.fields=t,this.bounding_box=this.fields[0].bounding_box.clone();for(let t=1;t<this.fields.length;++t)this.bounding_box.intersect(this.fields[t].bounding_box)}calculateSignedDistance(t,s,i){let h=this.fields[0].calculateSignedDistance(t,s,i);for(let e=1;e<this.fields.length;++e)h=Math.max(h,this.fields[e].calculateSignedDistance(t,s,i));return h}}class J extends A{constructor(t,s){super(),this.smoothness=t,this.fields=s,this.bounding_box=this.fields[0].bounding_box.clone();for(let t=1;t<this.fields.length;++t)this.bounding_box.union(this.fields[t].bounding_box)}calculateSignedDistance(t,s,i){let h=this.fields[0].calculateSignedDistance(t,s,i);for(let e=1;e<this.fields.length;++e){let n=this.fields[e].calculateSignedDistance(t,s,i),m=l(.5+.5*(n-h)/this.smoothness,0,1);h=n+(h-n)*m-this.smoothness*m*(1-m)}return h}}class K extends A{constructor(t,s){super(),this.smoothness=t,this.fields=s,this.bounding_box=this.fields[0].bounding_box.clone()}calculateSignedDistance(t,s,i){let h=this.fields[0].calculateSignedDistance(t,s,i);for(let e=1;e<this.fields.length;++e){let n=this.fields[e].calculateSignedDistance(t,s,i),m=l(.5-.5*(n+h)/this.smoothness,0,1);h=h+(-n-h)*m+this.smoothness*m*(1-m)}return h}}class W extends A{constructor(t,s){super(),this.smoothness=t,this.fields=s,this.bounding_box=this.fields[0].bounding_box.clone();for(let t=1;t<this.fields.length;++t)this.bounding_box.intersect(this.fields[t].bounding_box)}calculateSignedDistance(t,s,i){let h=this.fields[0].calculateSignedDistance(t,s,i);for(let e=1;e<this.fields.length;++e){let n=this.fields[e].calculateSignedDistance(t,s,i),m=l(.5-.5*(n-h)/this.smoothness,0,1);h=n+(h-n)*m+this.smoothness*m*(1-m)}return h}}function tt(t=20,s=20,i=20,h=0){return new T(t,s,i,h)}function st(t=20,s=20,i=20,h=5){return new U(t,s,i,h)}function it(t=5){return new B(t)}function ht(t=20,s=5){return new O(t,s)}function et(t=10,s=1/0){return new P(t,s)}function nt(t=new a){return new j(t)}function mt(t,s=new c){return new $(t,s)}function at(t,s){return new L(t,s)}function rt(t,s){return new N(t,s)}function ot(t,s){return new Q(t,s)}function ct(...t){return new G(t)}function lt(...t){return new R(t)}function xt(...t){return new H(t)}function dt(t,...s){return new J(t,s)}function ut(t,...s){return new K(t,s)}function _t(t,...s){return new W(t,s)}const yt=new q,pt=new E,zt=new a,Mt=new c,ft=new h(0,0,0),wt=[new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0),new k(0,0,0,0,0,0,0,0)];export{n as BoundingBox2,m as BoundingBox3,U as BoxFrameSignedDistanceField3,T as BoxSignedDistanceField3,Z as BufferWriter,P as CylinderSignedDistanceField3,R as DifferenceSignedDistanceField3,K as DifferenceSmoothSignedDistanceField3,t as EPSILON,s as INV_TWO_EPSILON,H as IntersectionSignedDistanceField3,W as IntersectionSmoothSignedDistanceField3,r as Matrix2,o as Matrix3,c as Matrix4,Q as OffsetSignedDistanceField3,a as Plane,j as PlaneSignedDistanceField3,g as PolygonIndices,b as PolygonMesh,E as SampleOctreeEmpty,q as SampleOctreeFull,F as SampleOctreeLeaf,V as SampleOctreeMeshBuilder,v as SampleOctreeRoot,N as ShellSignedDistanceField3,A as SignedDistanceField3,B as SphereSignedDistanceField3,O as TorusSignedDistanceField3,$ as TransformSignedDistanceField3,w as TriangleMesh,L as TwistSignedDistanceField3,G as UnionSignedDistanceField3,J as UnionSmoothSignedDistanceField3,i as Vector2,h as Vector3,e as Vector4,f as Vertex,p as bestDivisibleGridSize,tt as box,st as boxFrame,l as clamp,y as closestEvenlyDivisibleGridSize,C as convertToOBJ,I as convertToSTL,X as createSampleOctreeFromField,et as cylinder,lt as difference,ut as differenceSmooth,z as distanceFromOrigin,M as distanceSquared,x as gcf,xt as intersection,_t as intersectionSmooth,d as lcm,u as lerp,ot as offset,nt as plane,rt as shell,_ as smallestGridSize,it as sphere,ht as torus,mt as transform,Y as triangulateSignedDistanceField,at as twist,ct as union,dt as unionSmooth};
